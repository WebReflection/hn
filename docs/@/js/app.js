const e={initializeApp({databaseURL:e}){this.databaseURL=e},database(){const{databaseURL:e}=this,t=e=>e.json(),s={credentials:"same-origin"};return{ref:a=>({child:n=>({once(o,r){fetch(`${e}/${a}/${n}.json`,s).then(t).then(e=>r({val:()=>e}))}})})}}},t=self.requestIdleCallback||setTimeout;var s,a;Promise.all([(s="../@/3rd/uhtml.js",a="uhtml",new Promise(e=>{const t=document.createElement("script");t.onload=()=>e(self[a]),t.async=!0,t.src=s,document.head.appendChild(t)})),import("./hn.js"),import("./view.js")]).then(([s,{default:a},{default:n}])=>{const o=!(matchMedia("(display-mode: standalone)").matches||navigator.standalone||document.referrer.includes("android-app://")),{stories:r,story:i,item:c,user:d,parse:l}=a(e),{render:h,html:m}=s,{body:u}=document,{header:p,main:f,footer:b,about:g,details:v,profile:k,notFound:y}=n(s),L=()=>{u.classList.remove("loading")},$=(e,t)=>{h(u,m`${e}${t}${b()}`)},j=e=>{w=e,u.classList.add("loading");const{id:s,page:a,type:n,pathname:o,user:h}=l(e),m=p({page:a,header:{current:o,stories:r}});let b=!0;switch(n){case"item":const n=w;c(s).then(e=>{if(e){t(L);const s=e=>{const n=c(e);return n.then(e=>{e&&(n.model=e,e.comments=(e.kids||[]).map(s),b&&(b=!b,t(a)))}),n},a=()=>{n===w&&($(m,v(e)),b=!0)};e.comments=(e.kids||[]).map(s),a()}else $(m,y())});break;case"story":const l=w;i(o).then(e=>{t(L);const s=Math.ceil(e.length/20),n=20*(a-1),r=20*a,i=e.slice(n,r).map((e,s)=>{const a=c(e);return a.then(e=>{e&&(a.index=n+s+1,a.model=e,b&&(b=!b,t(d)))}),a}),d=()=>{l===w&&($(m,f(o,i,a,s)),b=!0)};d()});break;case"user":const u=w;d(h).then(e=>{u===w&&(e?(t(L),$(m,k(e))):(t(L),$(m,y())))});break;default:if(/\/about\/$/.test(e)){const e=w,s=p({page:a,header:{current:"about",stories:r}});g().then(a=>{e===w&&(t(L),$(s,a))})}else t(L),$(m,y())}};let w="";self.SSR||j(location.href),u.addEventListener("click",e=>{const{target:t}=e,s=t.closest("a");if(s){const t=s.getAttribute("href");/^(?:\.|\/)/.test(t)&&(e.preventDefault(),j(t),o&&history.pushState(null,document.title,t))}}),o&&self.addEventListener("popstate",()=>{j(location.href)}),"serviceWorker"in navigator&&navigator.serviceWorker.register("../sw.js",{scope:"../"})});