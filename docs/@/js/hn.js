const e=(e,t)=>{e.delete(t)};export default t=>{t.initializeApp({databaseURL:"https://hacker-news.firebaseio.com"});const s=t.database().ref("v0"),a=["top","new","show","ask","job"],n=new Map,r=t=>(n.get(t)||((t,s)=>{const a={t:setTimeout(e,3e5,n,t),$:s};return n.set(t,a),a})(t,new Promise(e=>{s.child(t).once("value",t=>e(t.val()))}))).$;return{stories:a,item:e=>r("item/"+e),user:e=>r("user/"+e),story:e=>r(e+"stories"),parse:e=>{const t={type:"unknown",id:-1,page:1,user:"",pathname:""};if(/\/([a-z]+)\/(\?[^&]+)$/.test(e)){const{$1:e,$2:s}=RegExp,n=s.slice(1);if("user"===e)t.pathname=e,t.type="user",t.user=n;else if("item"===e){const s=parseInt(n,10);s&&0<s&&(t.pathname=e,t.type="item",t.id=s)}else a.includes(e)&&(t.pathname=e,t.type="story",t.page=Math.max(parseInt(n,10)||1,1))}return t}}};